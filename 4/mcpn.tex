\ifpdf
	\graphicspath{{4/pic/PNG/}{4/pic/PDF/}{4/pic/}}
\else
	\graphicspath{{4/pic/EPS/}{4/pic/}}
\fi

\chapter{The $\MCPN$ approximation}\label{chap:mcpn}

The main goal of this chapter is to derive an alternative form of the $\PN$ approximation that provides additional
insight into the structure of the equations. In particular, it allows to derive 
the $\SPN[3]$ equations in a new way that we will present at the end of the chapter. % (by using a general approach that
% could be extended to higher order $\SPN$
%equations).
As in the exposition of the original $\PN$ method, we will focus on the monoenergetic equation $T\psi - q = 0$ a.e. in
$\XE$, that is
\begin{equation}\label{eq:MC-bte}
\begin{multlined}
    \bomega\cdot\nabla\psi(\br,\bomega) + \sigma_t(\br)\psi(\br,\bomega)\\ -
    \intA[']{\left[\sigma_s(\br,\bomega\cdot\bomega') + \frac{\nu\sigma_f(\br)}{4\pi}\right]\psi(\br,\bomega')} - q(\br,\bomega) = 0,\quad
    (\br,\bomega) \in \VV\times \Sphere  
\end{multlined}
\end{equation}
and assume that \mbox{$\psi(\cdot,\bomega)\in\Lp[2](\Sphere)$} (we have split the collision kernel $\kappa$ into the
scattering and fission part so that we can show how non-isotropic and isotropic terms are handled).
% in the discussion below (even though the final derivation in Sec. \ref{sec:mcpn} actually requires only 
% $\Lp[1](\Sphere)$ integrability)

\myparagraph{Notation conventions}
We introduce some new notation in this chapter. The new rules added to the notation conventions of
\cref{chap:nte-methods} are summarized in the following list.

\begin{itemize}
    \item $\AA$ $\ldots$ Cartesian tensor of rank $n$ (Def. \ref{def:tensor} below),
  	\item $\AAA{\alpha_1\cdots\alpha_n}$ $\ldots$ Cartesian tensor $\AA$ in an indexed notation,
    \item $\underset{m}{\cdot}$ $\ldots$ $m$-fold contraction (generalization of inner product, Def.
    \ref{def:contraction}),
    \item $\Sym{\AA}$ $\ldots$ symmetrization of tensor $\AA$ (Def. \ref{def:symmetrization}),
    \item $\trace \AA$ $\ldots$ trace of tensor $\AA$ (Def. \ref{def:trace}),
    \item Greek subscripts (as in $A^{(1)}_{\alpha})$ $\ldots$ indices of the Cartesian axes (with the
    correspondence $\alpha = 1,2,3 \leftrightarrow x,y,z$).
\end{itemize}

Let us start by recalling basic ingredients of the spherical harmonics method from \sref{sec:PN}, relevant for
subsequent sections.

\section{Classical $\PN$ approximation}\label{sec:SPH}
Being a square integrable function on $\Lp[2](\Sphere)$, $\psi(\cdot,\bomega)$ may be represented by a generalized
Fourier series expansion in terms of a complete orthonormal basis of this space. The $\PN$ method uses the basis of
(tesseral) spherical harmonics $\{\Y{n}{m}\}$ of degree $n\geq 0$ and order $-n \leq m \leq n$. A (semi-)finite
approximation is obtained by considering the NTE in a subspace $\Lp[2]_K(\Sphere)\subset\Lp[2](\Sphere)$ 
spanned by $\{\Y{n}{m}\}$,  $n \leq N$ (where we assume the more common case of odd $N$ and $K = (N+1)^2$ in general
three dimensional setting) -- i.e.
it consists of the expansion
\begin{equation}\label{eq:exp}
  \psi(\br,\bomega) \approx \suma[n]{0}{N}\suma[m]{-n}{n}\angmom{n}{m}(\br)\Y{n}{m}(\bomega)
\end{equation}
and orthogonal projection of the residual $T\psi - q$ onto $\Lp[2]_K(\Sphere)$ (similarly, the exact boundary conditions 
are projected onto $\Lp[2]_K(\pX[-])$, orthogonally to the subspace spanned by the complete set of even-degree spherical
harmonics).

We recall the \textit{addition theorem} for Legendre polynomials $P_n$:
\begin{equation}\label{eq:addition}
  P_n(\bomega\cdot\bomega') = \frac{4\pi}{2n+1}\suma[m]{-n}{n}\Y{n}{m}(\bomega)\Y{n}{m}(\bomega'),
\end{equation}
which allows to simplify the collision integral, after expansion of its (non-isotropic) kernel in terms of 
Legendre polynomials up to the \textit{degree of scattering anisotropy} $N_s$:
\begin{equation}\label{eq:exp2}
  \sigma_s(\br,\bomega\cdot\bomega') \approx \suma[k]{0}{N_s}
      \frac{2k+1}{4\pi}\sigma_{sk}(\br)P_k(\bomega'\cdot\bomega)
\end{equation}
%where
%$\Sigma_{sk}(\br) = 2\pi \muint[_0]{\P{k}(\mu_0)\Sigma_s(\br, \mu_0)}$
%are the coefficients of the expansion of the scattering cross-section 
% ROTATIONAL INVARIANCE OF SUBSP.
Also, we have the following relation between the spherical harmonic moments 
$$
	\angmom{n}{m}(\br) = \intA{\psi(\br,\bomega) \Y{n}{m}(\bomega)}
$$
(unknowns in the $\PN$ equations) and the important physical quantities (scalar flux, neutron current):
$$
	\phi = \sqrt{4\pi}\angmom{0}{0},\quad \bJ = \sqrt{\frac{4\pi }{3}}\, \left[\begin{array}{c}\angmom{1}{1}\\
	\angmom{1}{-1}\\ \angmom{1}{0}\end{array}\right].
$$

\section{Tensor form of spherical harmonics}\label{sec:tens_sph}
This standard procedure results in a system of $\PN$ equations given by eq. \eqref{eq:pn1}. It is possible to reduce
this system of first-order PDEs into a system of second-order equations, which gets however quite complicated
(\cite{ModestYang, Capilla}) and in no way resembles the simple elliptic system of the $\SPN$ approximation.
This motivates the search for an alternative form of the expansion \eqref{eq:exp} that would reveal some connection
with the computationally attractive $\SPN$ set.

\subsection{Surface and solid spherical harmonics}
A possible way of achieving this goal starts by studying the linear combinations of spherical harmonics of fixed
degree.
We will simplify the notation by setting $\mu = \cost$, replace $\bomega$ with $(\mu, \azimuthal)$ where necessary and also use the
following relations between the velocity and direction vectors in Cartesian coordinates:
$$
  \bv = [v_x, v_y, v_z]^T = v\bomega,\quad \bomega = [\Omega_x, \Omega_y, \Omega_z]^T = \frac{\bv}{v}.
$$
\index{v@$\bv$, v}
\begin{definition}\label{defn:SSH}\cite[Def. 3.22]{Schreiner}
  A general linear combination of the $2n + 1$ (tesseral) spherical harmonics of degree $n$ is called a \textit{surface spherical 
  harmonic of degree $n$} and can be written as
  \begin{equation}\label{eq:exp3}
    \mathcal{Y}_n(\mu,\azimuthal) = A_0 P_n(\mu) + \suma[m]{1}{n}\bigl[ A_m \cos(m\azimuthal)\P{n}{m}(\mu) + B_m
    \sin(m\azimuthal)\P{n}{m}(\mu)\bigr]
  \end{equation}
  where $A_m,B_m \in \R$ and  $\P{n}{m}$ are the \textit{associated Legendre polynomials} (eq.
  \eqref{eq:associated_Pn}).
  	\index{Y@$\mathcal{Y}_n$|see {surface spherical harmonic}}
	\index{surface spherical harmonic}
\end{definition}
Note that there is a one-to-one relationship between the coefficients in eq. \eqref{eq:exp} for fixed $n$ and the 
coefficients in \eqref{eq:exp3}.

\index{solid spherical harmonic}
Multiplying by $v^n$, we obtain the (regular) \textit{solid spherical harmonic}\footnote{Regular solid spherical
harmonics are one class of solutions of the Laplace equation \mbox{$\lap Y = 0$} in spherical coordinates
$(v,\azimuthal,\polar)$ which vanish as $v\to 0$. The other are the irregular solid spherical harmonics, which have
singularity of the form $v^{-n-1}$ at the origin (\cite[Chap. VI]{Byerly}).}. Solid spherical harmonics were utilized
in the early works \cite{Davison, Rumyantsev} as tools for analyzing the multidimensional spherical harmonics. Since
then, there appears to be no interest in solid spherical harmonics for approximating angular dependence of the NTE,
until the paper by Ackroyd \cite{Ackroyd1}. Ackroyd used these functions to arrive at a set of equations that can be
used for practical approximation of the solution of the NTE. Under the assumption of
isotropic scattering ($\sigma_{sk} = 0$ for $k \geq 1$ in \eqref{eq:exp2}) Ackroyd derived for a homogeneous region a set of coupled diffusion-like equations (called SH\PN) without any other
requirement (unlike the classical derivation of the $\SPN$ equations, which required certain assumptions about 
dimensionality or material properties, cf. the overview at the beginning of \sref{chap:SPN}),
together with heuristic boundary and interface conditions. As was shown in the paper, the SH\PN~ equations reduced by simple substitutions to the set of 
$\SPN$ equations originally formulated by Gelbard and it is interesting to note that this actually showed that the 
latter are within an isotropically scattering homogeneous medium equivalent to the full solid harmonics expansion -- 
the same result for surface spherical harmonics has been independently proved in \cite{Coppa1} and revisited recently 
(\cite{Coppa2,McClarren1}). Unfortunately, the general treatment in \cite{Ackroyd1} is very technically involved and in 
author's opinion quite difficult to follow -- this may be the reason why the idea has not been picked up and possible 
research directions outlined in the paper's conclusion not pursued.

\subsection{Cartesian tensors}\label{sec:tensors}
In order to describe a conceptually simpler and arguably also more useful approach, we need to recall some basic facts
about Cartesian tensors. We recall the convention that Greek subscripts (ranging from 1 to 3) represent axes of the
Cartesian coordinate system with unit vectors $\be_x$, $\be_y$, $\be_z$. We will also use the convenient Einstein's
summation convention which implies summation over any index that appears twice in an indexed expression, for instance $$
  \AAA[3]{\alpha\beta\gamma}\BBB[2]{\beta\gamma} =
  \suma[\beta]{1}{3}\suma[\gamma]{1}{3}\AAA[3]{\alpha\beta\gamma}\BBB[2]{\beta\gamma} = \CCC[1]{\alpha}.
$$

\begin{definition}\label{def:tensor}
  An $n$-dimensional array $\AA$ of $3^n$ components $\AAA{\alpha_1\ldots\alpha_n}$ is called \textit{Cartesian tensor 
  of rank $n$} if it transforms as
  \begin{equation}\label{eq:tenstran}
    A^{(n)'}_{\alpha_1\ldots\alpha_n} = g_{\alpha_1\beta_1}\cdots g_{\alpha_n\beta_n}\AAA{\beta_1\ldots\beta_n}
  \end{equation}
  under the change of coordinate system $Oxyz \to Ox'y'z'$ by the action of an orthogonal matrix $\mathbf{G} = [g_{\alpha\beta}]$:
  $$
    \be_\alpha' = g_{\alpha\beta}\be_\beta.
  $$
  \index{G@$\mathbf{G}$|see {orthogonal transformation}}\index{orthogonal transformation}%
\end{definition}
A special case of the matrix $\mathbf{G}$ was the rotation matrix $\mat{R}$ introduced in \sref{sec:rotinv}; here we
include also the reflections about origin to make the definition general. As we will only use the Cartesian tensors, we
will henceforth omit the word Cartesian. Word ``tensor'' will also be used for a general \textit{tensor field},
components of which are functions -- like $\AA(\br)$. The transformation has then the following form:
$$
  A^{(n)'}_{\alpha_1\ldots\alpha_n}(\br) = \AAA{\alpha_1\ldots\alpha_n}(\mathbf{G}^{T}\br) = g_{\alpha_1\beta_1}\cdots g_{\alpha_n\beta_n}\AAA{\beta_1\ldots\beta_n}(\br).
$$
We will denote by $\eye \equiv \eye^{(2)}$ the identity rank-2 tensor (matrix) and by $ \mathbb{O}^{(n)}$ the zero
rank-n tensor. The identity tensor can be written in the component notation via the Kronecker delta symbol
$$
	I_{ij} = \kron{i}{j}.
$$

Addition and subtraction of two tensors of same rank and multiplication of a tensor by a scalar are done component-wise. 
Multiplication of two tensors is defined as follows:
\begin{definition}
  Components of tensor $\CC[n+m] = \AA\otimes\BB[m]$ are given by
  $$
    \CCC[n+m]{\alpha_1\ldots\alpha_n\beta_1\ldots\beta_m} = \AAA{\alpha_1\ldots\alpha_n}\BBB{\beta_1\ldots\beta_m}.
  $$
\end{definition}

\begin{definition}
  $m$-th power of tensor $\AA$ is a tensor of rank $nm$ defined as
  $$
    \CC[nm] = \AA\otimes\AA\otimes\cdots\otimes\AA\quad \mbox{($m$-times)}
  $$
\end{definition}
We will mainly use powers of vectors and also consider the gradient operator as a vector
$$
  \nabla = \left[\pd{}{x}, \pd{}{y}, \pd{}{z}\right]^T;
$$
hence the Laplacian 
$$
	\lap = \pd[2]{}{x} + \pd[2]{}{y} + \pd[2]{}{z} = \nabla \cdot \nabla,
$$
while the Hessian operator (second rank tensor operator) with components
$$
	D^{(2)}_{\alpha\beta} = \pdd[2]{}{\partial x_\alpha \partial x_\beta} = \nabla \otimes \nabla.
$$
Also, for simplicity,
	$\nabla\AA \equiv \nabla\otimes\AA$.

\begin{definition}\label{def:contraction}
  For $1\leq m \leq n$, the $m$-fold contraction of tensors $\AA$ and $\BB$ is a rank-($2n-2m$) tensor 
  $\CC[2n-2m] = \AA\underset{m}{\cdot}\BB$ with components
  $$
    \CCC[2n-2m]{\alpha_{1}\ldots\alpha_{n-m}\beta_1\ldots\beta_{n-m}} = 
    \AAA{\alpha_1\ldots\alpha_{n-m}\gamma_{n-m+1}\ldots\gamma_n}\BBB{\gamma_n\ldots\gamma_{n-m+1}\beta_{n-m}\ldots\beta_1}.
  $$
\end{definition}
Specially for $n = m = 1$, we get the standard inner product of vectors (denoted by $\cdot$ so far), while for
$n = m = 2$ we get the double inner product (denoted by $:$) of matrices \eqref{eq:doubleprod}. Generally when $n = m$,
we obtain the scalar $\AAA{\gamma_1\ldots\gamma_n}\BBB{\gamma_n\ldots\gamma_1}$ and suppress the index under the $\cdot$
sign to simplify the writing (it should be clear from the two operands and their rank that a total contraction over all 
their indices is intended).

\begin{definition}
  For $m \leq \lfloor n/2 \rfloor$ (the integer part of $n/2$), the $m$-fold contraction of tensor $\AA$ (contraction 
  in $m$ index pairs) is a rank-($n-2m$) tensor with components
  $$
    \BBB[n-2m]{\alpha_{2m+1}\ldots\alpha_n} = \AAA{\alpha_1\alpha_1\ldots\alpha_m\alpha_m\alpha_{2m+1}\ldots\alpha_n}.
  $$
\end{definition}
When contracting in only 1 index pair, the $1$-fold contraction is simply called a contraction. The result has a special 
name:
\begin{definition}\label{def:trace}
  Contraction of tensor $\AA$ in one index pair is called \textit{trace} of $\AA$ in that pair:
  $$
    \trace \AA = \AAA[n]{\alpha_1\alpha_2\alpha_3\ldots\alpha_n}\kron{\alpha_1}{\alpha_2} =
    \AAA[n-2]{\alpha_1\alpha_1\alpha_3\ldots\alpha_n}.
  $$ 
\end{definition}
If the trace of $\AA$ in one index pair vanishes, the tensor is said to be traceless in that pair. Obviously then, if 
the tensor does not depend on the order of indices, it is traceless in all index pairs.
\begin{definition}
  Tensor $\AA$ is \textit{totally symmetric} if it is invariant under any permutation $\perm{\alpha_1\ldots\alpha_n}$ 
  of its indices:
  $$
    \AAA{\alpha_1\ldots\alpha_n} = \AAA{\perm{\alpha_1\ldots\alpha_n}}.
  $$
\end{definition}

\begin{definition}
  Totally symmetric tensor whose trace in any index pair vanishes is called \textit{totally symmetric traceless tensor} 
  and its trace vanishes in all index pairs. We will denote totally symmetric traceless tensors as TST tensors.
\end{definition}

We can make any tensor of rank $n$ totally symmetric by applying the symmetrization operator $\Sym{\cdot}$:
\begin{definition}\label{def:symmetrization}
  $\widetilde{\mathbb{A}}^{(n)} = \Sym\AA$ is a totally symmetric tensor with components
  $$
    \widetilde A^{(n)}_{\alpha_1\ldots\alpha_n} = \frac{1}{n!}\ \; \sum_{\mathclap{\perm{\alpha_1\ldots\alpha_n}}}\ \;\AAA{\alpha_1\ldots\alpha_n}.
  $$
\end{definition}  
As we will see shortly, there also exists an operator that makes a totally symmetric tensor totally symmetric and
traceless.

\subsection{Maxwell-Cartesian spherical harmonics}\label{sec:MCSH}
It is well known that any solid spherical harmonic of degree $n$, when expressed in Cartesian coordinates: $S_n(\bv) =
S_n(v_x, v_y, v_z) = v^n Y_n(\bv/v)$, is a harmonic polynomial, homogeneous of degree $n$ (\cite[Thm. 3.67]{Schreiner}),
i.e.
$$
  \lapv S_n(\bv) = 0,\quad S_n(\lambda\bv) = \lambda^n S_n(\bv)
$$ 
(in fact, there is an alternative definition of solid spherical harmonic as a function satisfying these two
properties and of surface spherical harmonic as a restriction of such function to the unit sphere). The space of such
polynomials has dimension $2n + 1$ \footnote{Homogeneous polynomial of degree $n$ has $\frac{(n+1)(n+2)}{2}$
coefficients; since $\lapv S_n(\bv)$ is a homogeneous polynomial of degree $n-2$ with $\frac{n(n-1)}{2}$ coefficients
expressed in terms of those of $S_n$, the condition $\lapv S_n(\bv) = 0$ reduces the number of independent coefficients
of $S_n$ to $\frac{(n+1)(n+2)}{2} - \frac{n(n-1)}{2} = 2n + 1$.}\label{pg:indepc} and is isomorphic to the space of TST
tensors of rank $n$ (\cite[Chap. 3]{Schreiner}).
% SEE AXLER HFT - L2(S_2) = direct sum of H_n(S_2)
In particular, when the components of such a tensor do not depend on $v_x$, $v_y$, $v_z$, (or $\Omega_x$, $\Omega_y$,
$\Omega_z$) they comprise coefficients of the solid (or surface) spherical harmonic and therefore also (in the
$\Sphere$-restricted case) the coefficients $\angmom{n}{m}(\br,E)$ in the expansion \eqref{eq:exp} (when transformed
back to spherical coordinates). Hence, by solving the set of tensorial equations with these tensors of ranks $n \leq N$
as unknowns, we accomplish essentially the same thing as by solving the ordinary $\PN$ equations, but we may 
additionally utilize the TST tensor character of the equations.

To construct this set, we will build on the ideas presented by Johnston (\cite{Johnston1}) and Applequist
(\cite{Applequist1}). Johnston arrived at a ``far more symmetric and compact'' (\cite[p. 1455]{Johnston1}) form of the
angularly discretized general Boltzmann-Vlasov equation by expanding the flow function in terms of
\textit{Maxwell-Cartesian spherical harmonic tensors} rather than the usual surface spherical harmonics. The term
``Maxwell-Cartesian spherical harmonic tensor'' has been coined by Applequist in \cite{Applequist2}, who in his older
paper \cite{Applequist1} showed a systematic way of obtaining a special TST tensor of any rank $n$ whose components are
spherical harmonics of degree $n$ in Cartesian frame of reference as defined by Maxwell in \cite[p. 160]{Maxwell}.
Specifically, in present notation, he showed that Maxwell's spherical harmonics based on Cartesian axes can be obtained
(up to a normalization constant) as components of $$
  \detr \bv^n \quad \mbox{(or $\detr \bomega^n$)}
$$ where $\detr$ is the so-called \textit{detracer operator} which projects a general totally symmetric tensor of rank
$n$ into the space of totally symmetric and traceless tensors of rank $n$. The result of
applying the detracer operator on a totally symmetric tensor $\AA$ is a TST tensor with components:
\begin{equation}\label{eq:detr}
\begin{multlined}
  \detr \AAA{\alpha_1\ldots\alpha_n} = \\ \suma[m]{0}{\lfloor n/2 \rfloor} \frac{(-1)^m(2n-2m-1)!!
  }{(2n-1)!!}\quad\sum_{\mathclap{\{\perm{\alpha_1\ldots\alpha_n}\}_{\text{d}}}}\quad\kron{\alpha_1}{\alpha_2}\cdots\kron{\alpha_{2m-1}}{\alpha_{2m}}\AAA{\beta_1\beta_1\ldots\beta_m\beta_m\alpha_{2m+1}\ldots\alpha_n},
\end{multlined}
\end{equation}
where $\{\perm{\alpha_1\ldots\alpha_n}\}_{\text{d}}$ denotes the set of all permutations that give distinct terms in 
the last sum (considering their total symmetry) and $$(2n-1)!! = (2n-1)(2n-3)\cdots 3\cdot 1 \quad \mbox{with}\quad
(-1)!! = 1.$$
The proof that $\detr \AAA{\alpha_1\ldots\alpha_n}$ is a traceless tensor is given in \cite[Sec.
5]{Applequist1} and we will not repeat it here as it is straightforward but technically involved. We note however that
we include the factor $(2n-1)!!$ in the denominator in \eqref{eq:detr} to make $\detr$ idempotent (and thus a true
projection).
%or, in a somewhat more transparent way, in \cite[Eqns. (36), (37)]{Vreoiju}.

Being general surface spherical harmonics according to Def. \ref{defn:SSH}, Maxwell's surface spherical harmonics are
linear combination of spherical harmonics and hence share many of the properties of the latter. An extensive presentation
of these properties is given in \cite{Applequist1,Applequist2} and we will recall some of them in further sections. We
will use the following form of Maxwell-Cartesian surface spherical harmonics of degree $n$ as components of rank-$n$ TST
tensors (called sometimes \textit{Maxwell-Cartesian tensors}):
\begin{equation}\label{eq:MCSH}
  \PP(\bomega) = \detr \bomega^n
\end{equation}
which differ from those used by Applequist in that they have coefficient $1$ at their first term but which coincide 
with those used by Johnston. 
 
We note that projection of $\PP$ along, say, $z$-axis (or any other because of the symmetry) yields (up to a
normalization factor) the Legendre polynomials:
\begin{equation}\label{eq:leg2}
  \PP(\bomega)\contr\be_z^n = P^{(n)}_{\alpha_1\ldots\alpha_n}\kron{3}{\alpha_1}\cdots\kron{3}{\alpha_n} = P^{(n)}_{33\ldots3} = \frac{n!}{(2n-1)!!}P_n(\mu) \equiv C_n P_n(\mu)
\end{equation}
and hence components of $\PP$ could be explicitly obtained by extending the well-known formulas for Legendre 
polynomials, for instance
\begin{equation}\label{eq:conn1}
\begin{multlined}
  \PP(\bomega) = \bomega^n - \frac{n(n-2)}{2(2n-1)}\Sym{\eye\otimes\bomega^{n-2}}\\[.2em] +
  \frac{n(n-1)(n-2)(n-3)}{8(2n-1)(2n-3)}\Sym{\eye^2\otimes\bomega^{n-4}}\mp\ldots
  \end{multlined}
\end{equation}
(\cite[Chap. VI]{Byerly}, \cite{Johnston1})
% or
%\begin{equation}\label{eq:conn2}
%  \PP[0](\bomega) = 1,\ \PP[n+1](\bomega) = \left[\bomega\otimes\PP[n](\bomega) - \tfrac{n^2}{4n^2-1}\eye\otimes\PP[n-1](\bomega)\right]_{\mbox{\scriptsize sym}},\ n = 1,2,\ldots.
%\end{equation}
First few Maxwell-Cartesian surface harmonics generated by this formula are shown in the table below together with the 
corresponding spherical harmonics and Legendre polynomials.
\begin{center}
	\begin{tabular}{|A|B|C|D|}
	  \hline
		n & $\YY(\bomega)\propto$ & $\PP(\bomega)$ & $C_n P_n(\mu)$ \nl
		0 & 1 & 1 & 1\nl
		1 & $\Omega_x$, $\Omega_y, \Omega_z$ & $\Omega_x$, $\Omega_y$, $\Omega_z$ & $\mu$ \nl
		2 & $-\Omega_x^2-\Omega_y^2 + 2\Omega_z^2$, 
		    $\Omega_y\Omega_z$, 
		    $\Omega_z\Omega_x$,
		    $\Omega_x\Omega_y$,
		    $\Omega_x^2 - \Omega_y^2$ & $\Omega_x^2-\tfrac13$, 
		                                $\Omega_y^2-\tfrac13$, 
		                                $\Omega_z^2-\tfrac13$, 
		                                $\Omega_x\Omega_y$, 
		                                $\Omega_x\Omega_z$, 
		                                $\Omega_y\Omega_z$ & $\mu^2 - \tfrac13$ \nl
	\end{tabular}
	\captionof{table}{Spherical harmonics, Maxwell-Cartesian surface harmonics and Legendre polynomials up to
	degree $n = 2$.}
	\label{tab:harmonics}
\end{center}
 The symmetric nature of the Maxwell-Cartesian surface harmonics as opposed to the ordinary spherical harmonics can be
 seen from the third row in the table. We also note that since there are $\frac{(n+1)(n+2)}{2}$ distinct components in a general 
 totally symmetric tensor of rank $n$, the number of Maxwell-Cartesian harmonics is greater than the number of spherical 
 harmonics of the same degree, which is ($2n + 1$) for $n \geq 2$. However, due to the $\frac{n(n-1)}{2}$ conditions 
 arising from the tracelessness property, there are just $2n + 1$ independent components in $\PP$ (see also the footnote 
 on pg. \pageref{pg:indepc}). This also indicates the fact that unlike the spherical harmonics with same degree but
 different orders, components of $\PP$ are not all $\Lp[2](\Sphere)$-orthogonal. Nevertheless, Maxwell-Cartesian surface
  tensors of different degrees are orthogonal in the following sense:
\begin{equation}\label{eq:OG}
  \intA{\PP[n](\bomega) \otimes \PP[m](\bomega)} = \mathbb{O}^{m+n},\quad n\neq m.
\end{equation}

The Maxwell-Cartesian tensors have been actively used for solving various electro-magnetics and quantum-mechanical
problems (see the references in \cite{Applequist2}), but there is apparently only one attempt to bring them to the field
of neutron transport. In a recent article \cite{Coppa3}, Coppa re-derived the Maxwell-Cartesian surface spherical
harmonic tensors from their analogy with Legendre polynomials (see above) and the requirement that they satisfy the
addition theorem of the form \eqref{eq:addition}. The paper then proceeds by multiplying the NTE with these tensors and
integrating over the sphere to obtain a system of tensorial equations, each of which being itself a symmetric set of
PDE's determining the components of the flux moment tensor defined by
\begin{equation*}
  \psi^{(n)}(\br) = \intA{\psi(\br,\bomega)\PP[n](\bomega)}.\tag{\cite[Eqn. (41)]{Coppa3}}
\end{equation*}
Note that this definition implies that the flux moment tensors $\psi^{(n)}$ are totally symmetric and traceless. 
However, only the symmetry property appears to be recognized in \cite{Coppa3}. Using rather complicated tensor
relations, the system is constructed again by analogy with the procedure leading to the $\PN$ system. This could be
misleading, however, as there is no indication of in what sense the moments obtained by solving the set could be
interpreted as coefficients in an expansion of angular flux. Note that in the usual $\PN$ method where the angular flux 
is expanded into a series of spherical harmonics, the key ingredient that allows us to deduce 
%that allow us to deduce from the residual projection condition
%$$
%  \suma[n']{0}{\infty}\suma[m']{-n'}{n'}\Y{n'}{m'}(\bomega)\intA{\left[T\psi(\br,\bomega) - q(\br,\bomega)\right] \Y{n}{m}(\bomega)} = 0
%$$
%that 
%$$
%  \intA{\left[T\psi(\br,\bomega) - q(\br,\bomega)\right] \Y{n}{m}(\bomega)} = 0\quad \forall n,m
%$$
%(which leads to the moment equations analogous to \cite[Eqn. (48)]{Coppa3}) 
the system of equations analogous to \cite[Eqn. (48)]{Coppa3}) for the coefficients in the expansion is orthogonality 
(and hence linear independence) of all $\Y{n}{m}$. We do not have this property in the set of Maxwell-Cartesian 
harmonics (which does not seem to be taken into account in \cite{Coppa3}). 

This missing part of Coppa's derivation can be filled-in by taking into 
account the tracelessness property of the Maxwell-Cartesian tensors. This will be demonstrated in the following
section using the results of Johnston (\cite{Johnston1}) and Applequist (\cite{Applequist1}). We will see that
this more fundamental approach leads to a set of equations equivalent with \cite[Eqn. (42)]{Coppa3}. We will also see a 
clear connection to the 1D $\PN$ equations (based on the expansion of angular flux in Legendre polynomials) which could 
be expected from the formal equivalence of the Maxwell-Cartesian tensors and Legendre polynomials mentioned above 
(\eqref{eq:conn1},
%\eqref{eq:conn2}, 
Tab. \ref{tab:harmonics}). Motivated by this observation, we will finally exhibit the
connection between the derived equations and the $\SPN[3]$ equations in \sref{sec:mcp3_red}\footnote{Analogous
relationship with the $\PN[1]$ and $\SPN[2]$ equations have been shown in \cite{Coppa3}.}.

\section{Derivation of the $\MCPN$ approximation}\label{sec:mcpn}
\subsection{First attempts}
Using the results of \sref{sec:dirinvPN}, the expansion of angular neutron flux in terms of surface spherical 
harmonics can be written as\footnote{with the equality considered in the sense that $$f = \sum_{n=0}^{\infty}g_{n}\
\Leftrightarrow\ \lim_{n\to\infty} \left\Vert f - \sum_{k=0}^{n} g_{k} \right\Vert_{\Lp[2](\Sphere)} = 0$$}
\begin{equation}\label{eq:MC-exp1}
  \psi(\br,\bomega) = \suma[n]{0}{\infty}\frac{2n+1}{4\pi}\intA{\psi(\br,\bomega')P_n(\bomega\cdot\bomega')}.
\end{equation}
As shown in \cite[Sec. 7, Corollary II]{Applequist1}, Maxwell-Cartesian tensors
satisfy the following form of addition theorem:
\begin{equation}\label{eq:MC-addition}
  \PP(\bomega)\contr\PP(\bomega') = C_n P_n(\bomega\cdot\bomega')
\end{equation}
($C_n$ defined in \eqref{eq:leg2}). Combining the two results, we obtain
\begin{equation}\label{eq:MC-exp2}
  \psi(\br,\bomega) = \suma[n]{0}{\infty}\frac{2n+1}{4\pi
  C_n}\left[\intA[']{\psi(\br,\bomega')\PP(\bomega')}\right]\contr\PP(\bomega).
\end{equation}
If we now define the \textit{$n$-th angular flux moment tensor} by
\begin{equation}\label{eq:flux-moment}
  \fmom(\br) \coloneqq \frac{2n+1}{4\pi C_n}\intA{\psi(\br,\bomega)\PP(\bomega)}
\end{equation}
equation \eqref{eq:MC-exp2} becomes
\begin{equation}\label{eq:MC-exp3}
  \psi(\br,\bomega) = \suma[n]{0}{\infty}\fmom(\br)\contr\PP(\bomega).
\end{equation}
Note that we have, similarly to the $\PN$ case, 
$$
	\phi = 4\pi\fmom[0],\quad \bJ = \frac{4\pi }{3}\, \left[\begin{array}{c}\fmom[1]_x\\
	\fmom[1]_y\\ \fmom[1]_z\end{array}\right].
$$

Although equation \eqref{eq:MC-exp3} with \eqref{eq:flux-moment} looks like a (generalized) Fourier series, we should 
keep in mind that
$$
  \intA{\PP[m](\bomega)\otimes\suma[n]{0}{\infty}\fmom(\br)\contr\PP(\bomega)} \neq \fmom[m]
$$
in general and regard \eqref{eq:flux-moment} as definition.

We analogously expand also the volumetric source term, leading to 
\begin{equation}\label{eq:MC-exp_src}
  q(\br,\bomega) = \suma[n]{0}{\infty}\qmom(\br)\contr\PP(\bomega)
\end{equation}
with
\begin{equation*}
  \qmom(\br) \coloneqq \frac{2n+1}{4\pi C_n}\intA{q(\br,\bomega)\PP(\bomega)}.
\end{equation*}

To find the relations that must be satisfied by the angular expansion moments $\fmom(\br)$ in order for
\eqref{eq:MC-exp3} (or equivalently \eqref{eq:MC-exp1}) to be the solution of the transport equation \eqref{eq:MC-bte},
we insert the expansion \eqref{eq:MC-exp3} into \eqref{eq:MC-bte} (with source term represented according to \eqref{eq:MC-exp_src}).
Let us first look at the transfer part.
Applying eq. \eqref{eq:MC-addition} in the expansion \eqref{eq:exp2}, we immediately simplify the scattering
term\footnote{In practice, the scattering cross-section moments $\sigma_{sn}$ are available only up to a
certain anisotropy degree $N_s \leq \infty$; in that case we set $\sigma_{sn} = \sigma_{sk}$ for $n
\leq N_s$ and $\sigma_{sn} = 0$ otherwise.}:
\begin{equation*}%\label{eq:scat}
  \begin{multlined}
  \intA[']{\sigma_s(\br,\bomega\cdot\bomega')\psi(\br,\bomega')} = 
    \suma[n]{0}{\infty}
    \frac{2n+1}{4\pi}\sigma_{sn}(\br)\intA[']{P_n(\bomega'\cdot\bomega)\psi(\br,\bomega')}\\[.1em]
   \begin{aligned}
     &= \suma[n]{0}{\infty}
    \frac{2n+1}{4\pi C_n}\sigma_{sn}(\br)\left[\intA[']{\PP(\bomega')\psi(\br,\bomega')}\right]\contr\PP(\bomega)\\
     &= \suma[n]{0}{\infty}
    \sigma_{sn}(\br)\fmom(\br)\contr\PP(\bomega).
   	\end{aligned}
    \end{multlined}
\end{equation*}
Using def. \eqref{eq:flux-moment}, the fission part will has the expected form:
\begin{equation}%\label{eq:scat}
  \intA[']{\frac{\nu\sigma_f(\br)}{4\pi}\psi(\br,\bomega')} = 
  \frac{\nu\sigma_f(\br)}{4\pi}\intA[']{\psi(\br,\bomega')} = 
     \nu\sigma_f(\br)\phi(\br).
\end{equation}
Therefore, by inserting \eqref{eq:MC-exp3} into \eqref{eq:MC-bte} and using these results we obtain
\begin{equation}\label{eq:MC-bte2}
  \suma[n]{0}{\infty}\left[\bomega\cdot\nabla\fmom + \sigma_t\fmom 
  - \sigma_{sn}\fmom[n] - \kron{n}{0}\nu\sigma_f\phi - \qmom\right]\contr\PP(\bomega) = 0
\end{equation}
where each term in the brackets is dependent only on $\br$ (which is omitted for brevity).

Formulation of the moment equations for $\fmom(\br)$ is now hampered by linear dependence among certain functions in
each $\PP(\bomega)$ (so that we cannot deduce from \eqref{eq:MC-bte2} that for each $n$, all components of the
expression in brackets must vanish), as well as by the advection term which still contains $\bomega$. Both issues may be
however overcome by the so-called \textit{detracer exchange theorem} (\cite[Sec. 5.2]{Applequist2}).
\begin{theorem}\label{thm:detex}
  If $\AA$ and $\BB$ are totally symmetric tensors of rank $n$, then
  $$
    \AA\contr\detr \BB = \BB\contr\detr \AA.
  $$
\end{theorem}
\begin{proof}
  The theorem easily follows from the definitions of the detracer operator \eqref{eq:detr} and tensor contraction.
\end{proof}
Since $\fmom(\br)$ is by definition totally symmetric and traceless and $\bomega^{n}$ totally symmetric, using Theorem 
\ref{thm:detex} with $\AA \equiv \fmom(\br)$ and $\BB \equiv \bomega^{n}$ and the definition \eqref{eq:MCSH} of 
Maxwell-Cartesian tensors shows that\footnote{Recall that the detracer is a projection operator into the space of 
TST tensors and thus leaves the already TST tensor unchanged.} 
$$
  \fmom(\br)\contr\PP(\bomega) = \fmom(\br)\contr\bomega^n
$$
and the expansion \eqref{eq:MC-exp3} is thus equivalent to a power series in $\bomega$:
$$
  \psi(\br,\bomega) = \suma[n]{0}{\infty}\fmom(\br)\contr\bomega^n
$$
(similarly for \eqref{eq:MC-exp_src}). The advection term therefore simplifies as follows:
$$
  (\bomega\cdot\nabla)\fmom\contr\bomega^n = \left.
  \pw{\Omega_\beta\gradcomp\beta\fmom_{\alpha_0,\ldots,\alpha_{n-1}}\Omega_{\alpha_{n-1}}\cdots\Omega_{\alpha_0}}{if $n \geq 1$}
     {\Omega_\beta\gradcomp\beta\phi}{if $n = 0$}\right\}
   = \nabla\fmom\contr[n+1]\bomega^{n+1}
$$
for $n = 0,1,\ldots$ and by reindexing:
$$
  (\bomega\cdot\nabla)\fmom[n-1]\contr\bomega^{n-1} = \nabla\fmom[n-1]\contr[n]\bomega^{n}
$$
for $n = 1,2,\ldots$. We can therefore rewrite eq. \eqref{eq:MC-bte2} as
\begin{equation}\label{eq:MC-bte3}
  \suma[n]{0}{\infty}\left[\nabla\fmom[n-1] + \sigma_t\fmom
  - \sigma_{sn}\fmom - \kron{n}{0}\nu\sigma_f\phi - \qmom\right]\contr\bomega^n = 0
\end{equation}
with the term with negative rank discarded. Although eq. \eqref{eq:MC-bte3} closely resembles a vanishing linear 
combination of monomials
\footnote{Since we will not need to distinguish between the position vector $\br$ and the velocity vector $\bv$ here, 
we use the standard Cartesian coordinates $[x,y,z]$ for the latter as well.}
$$
  \bv^n = x^{n_1}y^{n_2}z^{n_3},\quad n_1 + n_2 + n_3 = n
$$
whose linear independence would imply that the expression in brackets must be a zero tensor for each $n$, by examining 
the not fully sensible equations that we would obtain in this way we might suspect that this is not the case. 
The reason is given in the following section.

\subsection{Linear independence of monomials restricted to $\Sphere$}
When monomials $\bv^n$ of different degrees are restricted to the unit sphere, there appear nontrivial but vanishing
linear combinations of them (consider e.g. \linebreak\mbox{$\Omega_x^2 + \Omega_y^2 + \Omega_z^2 - 1$}). However, when
only the components of $\bomega^n$ for a \textsl{single} $n$ are considered, they \textsl{are} linearly independent according to
the following lemma.
\begin{lemma}
  Let $n\in\mathbb{N}_0$ be fixed. If $\AA$ is a totally symmetric tensor of rank $n$, independent of $\bomega$, and
  \begin{equation}\label{eq:lemma1}
    \AA\contr\bomega^n = 0,
  \end{equation}
  then $\AA = \mathbb{O}^{(n)}$.
\end{lemma}
\begin{proof}
  If $\AA$ is a totally symmetric tensor, then 
  $$
    \AA\contr\bomega^n = \frac{1}{v^n}\AA\contr\bv^n
  $$
  represents a linear combination of monomials of degree $n$,  with coefficients being the components of $\AA$. By 
  linear independence of these monomials we conclude that if the equality \eqref{eq:lemma1} holds, then all components 
  of $\AA$ must vanish.
\end{proof}

One possibility how to extend the above result to an arbitrary linear combination of direction tensors with different
ranks is to require the moment tensors to be not only totally symmetric, but also traceless.

\begin{theorem}\label{thm:MC-suffcond}
  If $\AA$ is a TST tensor independent of $\bomega$ for all $n = 0,1,\ldots$ and
  $$
    \suma[n]{0}{\infty}\AA\contr\bomega^n = 0,
  $$
  then $\AA = \mathbb{O}^{(n)}$ for all $n$.
\end{theorem}
\begin{proof}
  As discussed in Sec. \ref{sec:MCSH}, any TST tensor $\AA$ uniquely identifies a surface spherical harmonic of degree 
  $n$ by 
  $$
    \mathcal{Y}_n(\bomega) = \AA\contr\bomega^n.
  $$
  Since surface spherical harmonics of different degrees are linearly independent,
  $$
    \suma[n]{0}{\infty} \mathcal{Y}_n(\bomega) = 0\quad \Rightarrow \quad \mathcal{Y}_n(\bomega) = 0 \ \ \forall{n}.
  $$
  The conclusion follows from the above lemma.
\end{proof}

\subsection{The $\MCPN$ approximation}
\index{method!of Maxwell-Cartesian spherical harmonics|(}
Using Thm. \ref{thm:MC-suffcond}, we see that we can obtain from \eqref{eq:MC-bte3} a set of moment equations if we
ensure that the expression in square brackets is a TST tensor for each $n$. Since $\fmom$ and $\qmom$ are TST by
definition, we only have to symmetrize and detrace the advection terms. We need to be careful, however, not to change
the original equation. This can be done by a clever rearranging of the terms in the sum.

First note that thanks to the symmetry of $\bomega^n$ we obviously have $$
  \nabla\fmom[n-1]\contr\bomega^n = \Sym{\nabla\fmom[n-1]}\contr\bomega^n.
$$ The symmetrized advection terms can be put into an equivalent TST form by $$
  \Sym{\nabla\fmom[n-1]} = \detr\Sym{\nabla\fmom[n-1]} - \left(\detr\Sym{\nabla\fmom[n-1]} -
  \Sym{\nabla\fmom[n-1]}\right).
$$ The result of the detracer operation on $\Sym{\nabla\fmom[n-1]}$ can be seen by using $$
  \AAA{\alpha_1\ldots\alpha_n} = \Sym{\gradcomp{\alpha_1}\fmom[n-1]_{\alpha_2\ldots\alpha_n}},\quad n \geq 2
$$ in eq. \eqref{eq:detr}. Taking into account the tracelessness of $\fmom[n-1]$, the only nonzero terms in the outer
sum will be those with $m = 0$ and $m = 1$. For $m = 0$, we obtain just the original tensor $\AA =
\Sym{\nabla\fmom[n-1]}$, while for $m = 1$, we obtain the inner sum over terms
\begin{equation*}
  \Sym{\kron{\alpha_1}{\alpha_2}\gradcomp{\beta}\fmom[n-1]_{\beta\alpha_3\ldots\alpha_n}},\quad
  \Sym{\kron{\alpha_1}{\alpha_3}\gradcomp{\beta}\fmom[n-1]_{\alpha_2\beta\alpha_4\ldots\alpha_n}},\quad\mbox{etc.},
\end{equation*}
that is $n-1$ times $\Sym{\eye\otimes\nabla\cdot\fmom[n-1]}$. We therefore get
\begin{equation}
\begin{aligned}\label{eq:MC-split0}
  \nabla\fmom[n-1]\contr\bomega^n &= \Sym{\nabla\fmom[n-1]}\contr\bomega^n\\
    & = \Sym{\nabla\fmom[n-1] - \frac{n-1}{2n-1}\eye\otimes\nabla\cdot\fmom[n-1] + \frac{n-1}{2n-1}\eye\otimes\nabla\cdot\fmom[n-1]}\contr\bomega^n\\
    & = \Sym{\nabla\fmom[n-1] - \frac{n-1}{2n-1}\eye\otimes\nabla\cdot\fmom[n-1]}\contr\bomega^n \\
    & +\quad \frac{n-1}{2n-1}\left(\nabla\cdot\fmom[n-1]\right)\contr\bomega^{n-2}
\end{aligned}
\end{equation}
where the last equality comes from the realization that $\eye\cdot\bomega^2 = \bomega\cdot\bomega = 1$ and 
$\nabla\cdot\fmom[n-1]$ is totally symmetric since $\fmom[n-1]$ is. 
Note that we have actually obtained that
\begin{equation}\label{eq:MC-split}
  \nabla\fmom[n-1]\contr\bomega^n = \detr\Sym{\nabla\fmom[n-1]}\contr\bomega^n + 
  \frac{n-1}{2n-1}\left(\nabla\cdot\fmom[n-1]\right)\contr\bomega^{n-2}.
\end{equation}
Eq. \eqref{eq:MC-split} shows that even though $\nabla\fmom[n-1]$ by itself is neither symmetric nor traceless, its 
contraction with $\bomega^n$ can be split into a sum of two contractions of TST tensors (total symmetry and 
tracelessness of the latter follows from the fact that $\fmom[n-1]$ is TST). By introducing this splitting into eq. 
\eqref{eq:MC-bte3} and regrouping the sum by $\bomega^n$, we finally obtain
\begin{equation}\label{eq:MC-bte4}
\begin{multlined}
  \suma[n]{0}{\infty}\left\{\Sym{\nabla\fmom[n-1] - \frac{n-1}{2n-1}\eye\otimes\nabla\cdot\fmom[n-1]} + \frac{n+1}{2n+3}\nabla\cdot\fmom[n+1]+\right.\\
  \left.\vphantom{\Sym{\nabla\fmom[n-1] - \frac{n-1}{2n-1}\eye\otimes\nabla\cdot\fmom[n-1]} + \frac{n+1}{2n+3}\nabla\cdot\fmom[n+1]}
     + \sigma_t\fmom - \sigma_{sn}\fmom - \kron{n}{0}\nu\sigma_f\phi - \qmom
  \right\}\contr\bomega^n = 0
\end{multlined}
\end{equation}
(again with the non-sensical tensors with negative ranks discarded).

Equation \eqref{eq:MC-bte4} is completely equivalent to eq. \eqref{eq:MC-bte3} or \eqref{eq:MC-bte2}, but regrouped to a
form of vanishing linear combination of $\bomega^n$ with TST coefficient tensors for each $n$. Theorem
\ref{thm:MC-suffcond} therefore applies and we get the desired set of first-order partial differential equations for the
angular flux moments:
\begin{equation}\label{eq:MC-set}
\begin{multlined}
  \frac{n+1}{2n+3}\nabla\cdot\fmom[n+1] + \Sym{\nabla\fmom[n-1] - \frac{n-1}{2n-1}\eye\otimes\nabla\cdot\fmom[n-1]}
  \\[.2em]+ \sigma_t\fmom - \sigma_{sn}\fmom - \kron{n}{0}\nu\sigma_f\phi = \qmom,\qquad n = 0,1,\ldots
\end{multlined}
\end{equation}

 Note that in passing to a finite approximation by the simplest closure \linebreak$\nabla\cdot\fmom[N+1] \equiv
\mathbb{O}^{(N)}$ for some $N \geq 0$, we do not spoil the TST character of the $N$-th coefficient tensor (in view of
\eqref{eq:MC-split0}, this closure actually means that we are neglecting the nonzero traces of $\nabla\fmom[N-1]$).
The set \eqref{eq:MC-set} for $n \leq N$ may be regarded as an alternative to the ordinary $\PN$ equations and because
its solution represents the expansion of angular flux into Maxwell-Cartesian surface spherical harmonics of degrees up
to $N$, it will be called \textit{$\MCPN$ approximation}.

\section{The $\MCPN[3]$ equations}
We now explicitly state the first four tensor equations in the
$\MCPN$ set. Let $$\Sa{n} = \sigma_t - \sigma_{sn} - \kron{n}{0}\nu\sigma_f.$$ Then the $\MCPN[3]$ equations read

\begin{equation}\label{eq:MCP3}
	\begin{aligned}
    \tfrac{1}{3}\nabla\cdot\fmom[1] 
      +   {\Sigma}_{0}\phi
      &=  {q}^{(0)} \\[.2em]
    \tfrac{2}{5} \nabla\cdot\fmom[2] + \nabla\phi 
      +   {\Sigma}_{1}\fmom[1] 
      &=  {q}^{(1)}  \\[.2em]
    \tfrac{3}{7} \nabla\cdot\fmom[3] + \Sym{\nabla\otimes\fmom[1]} - \tfrac{1}{3} \eye\otimes\nabla\cdot\fmom[1]
      +   {\Sigma}_{2}\fmom[2]
      &=  {q}^{(2)}  \\[.2em]
                                       \Sym{\nabla\otimes\fmom[2]} - \tfrac{2}{5} \Sym{\eye\otimes\nabla\cdot\fmom[2]}
      +   {\Sigma}_{3}\fmom[3]
      &=  {q}^{(3)}
    \end{aligned}
\end{equation}
(where we included the $\otimes$
symbol whenever multiplication of tensors of rank $\geq 1$ occurred).
We can see that the $\MCPN[1]$ set is equivalent to the $\PN[1]$ set. For $N \geq 3$, we have to take into account the
definition of the moments as \textit{traceless} totally symmetric tensors. If we considered general symmetric
moment tensors 
\begin{equation}\label{eq:fmom2}
	\fmom[2] = \left[
\begin{array}{ccc}
 \fmom[2]_{11} & \fmom[2]_{12} & \fmom[2]_{13} \\[.2em]
 \fmom[2]_{12} & \fmom[2]_{22} & \fmom[2]_{23} \\[.2em]
 \fmom[2]_{13} & \fmom[2]_{23} & \fmom[2]_{33} \\
\end{array}
\right]
\end{equation}
and similarly for $\fmom[3]$, etc., we would obtain more linearly independent equations than in the corresponding $\PN$
set. However, by restricting to TST tensors (e.g. by using the detraced versions of \eqref{eq:fmom2} and higher moments:
$$
\footnotesize
\detr\fmom[2] = \left[
\begin{array}{ccc}
 \frac{1}{3} (2 \fmom[2]_{11}-\fmom[2]_{22}-\fmom[2]_{33}) & \fmom[2]_{12} & \fmom[2]_{13} \\[.2em]
 \fmom[2]_{12} & \frac{1}{3} (-\fmom[2]_{11}+2 \fmom[2]_{22}-\fmom[2]_{33}) & \fmom[2]_{23} \\[.2em]
 \fmom[2]_{13} & \fmom[2]_{23} & \frac{1}{3} (-\fmom[2]_{11}-\fmom[2]_{22}+2 \fmom[2]_{33}) \\
\end{array}
\right])
$$
we obtain the same number of linearly independent equations in the set \eqref{eq:MC-exp3} as in the $\PN$ set. Moreover,
these equations can be written in the form of \eqref{eq:pn1}:
\begin{equation}\label{eq:mcpn1}
	\mat{A}_{\MCPN[3]}^x\,\pd{\Phi}{x} + \mat{A}_{\MCPN[3]}^y\,\pd{\Phi}{y} +
	\mat{A}_{\MCPN[3]}^z\,\pd{\Phi}{z} + \bigl[\sigma_t\mat{I} - \mathbf{K}_{\MCPN[3]}\bigr]\Phi =
	\mathrm{Q},
\end{equation}
where $\Phi$ and $\mathrm{Q}$ now contain the different $\MCPN[3]$ moments -- e.g. $\Phi$ is a column vector with
components 
$$
\begin{gathered}
\phi,\\[.75em]
\fmom[1]_{1},\fmom[1]_{2},\fmom[1]_{3},\\[.75em]
\fmom[2]_{11},\fmom[2]_{12},\fmom[2]_{13},\fmom[2]_{22},\fmom[2]_{23},\fmom[2]_{33},\\[.75em]
\fmom[3]_{111},\fmom[3]_{211},\fmom[3]_{311},\fmom[3]_{221},\fmom[3]_{321},\fmom[3]_{331},\fmom[3]_{222},\fmom[3]_{322},\fmom[3]_{332},\fmom[3]_{333}.
\end{gathered}
$$
The advection matrices $\mat{A}_{\MCPN[3]}^x$, $\mat{A}_{\MCPN[3]}^y$, $\mat{A}_{\MCPN[3]}^z$ have the same eigenvalues,
which are moreover equal to those of the advection matrices of the $\PN$ approximation (only the multiplicity
of the zero eigenvalue is greater, reflecting the linear dependence between the $\MCPN[3]$ equations) -- see App.
\ref{app:D}. The paper \cite{Applequist1} shows how to systematically select linearly independent subsets of the TST
tensors, which could be used to actually solve the $\MCPN[3]$ equations. However, we stress that this is not our
intention since this would be no easier than solving the ordinary $\PN$ equations. Rather, we will try to exploit the
symmetric and traceless structure of the $\MCPN$ equations to provide a new perspective on the $\SPN$ approximation
presented in \cref{chap:SPN}.

When
each moment tensor is projected along a chosen axis (say $z$), we obtain one dimensional equations which are exactly
the same as the 1D $\PN$ equations (since both symmetrized terms in every $n \geq 2$ $\MCPN$ equation become equal to
$\der{\fmom[n-1]_z}{z}$) if we take into account the definition of moments in the classical $\PN$ equations and multiply
each $\fmom[n]_z$ accordingly by a factor ${2n+1}$ (similarly, by multiplying each $\fmom[n]$ by $\frac{n!}{(2n-1)!!}$, 
we arrive at the system derived by Coppa \cite{Coppa3}). This indicates the possibility to investigate the original ad-hoc
derivation of the $\SPN$ equation by formal extension of the 1D $\PN$ equations into 3D in the current tensorial
framework.  

\comment{
and then
decompose it into its scalar, vector and tensor components. Under the physically motivated assumption that the neutron current be a conservative (curl-free) vector field, we will see that
the vector mode vanishes; moreover, extending this assumption also to the third-order moment, the tensor mode will also
vanish, leaving only the scalar mode (which involves only the scalar flux unknown). The assumptions about
conservativity of odd-order moments thus allow us to express $\fmom[2]$ in terms of the scalar flux and neutron sources. 
completely determined by its scalar mode Under the assumption that the odd-order moments are conservative (curl-free), \comment{ There is also an interesting link to an old article of Selengut (\cite{Selengut}) in which the full multidimensional $\PN[3]$ solution is obtained by solving a set of two coupled diffusion-like equations\footnote{much like in the $\SPN[3]$ approximation, but apparently without restrictions on dimensionality or cross-sections other than the usual isotropic scattering and volumetric source assumptions} with special interface conditions in presence of multiple heterogeneous
regions. Selengut's derivation of the set is however quite puzzling (see also commentary in \cite[Sec. 5.2]{McClarren2})
and his equations have, as far as the author of this thesis can tell, never been either analyzed or at least numerically
tested.
}}

\subsection{Reduction of the $\MCPN[3]$ system}\label{sec:mcp3_red}
In an analogy to the simplified $\PN$ approach, we start this investigation by reducing the system
\eqref{eq:MCP3} to two equations governing the even-order tensorial moments $\fmom[0]$ and $\fmom[2]$. We need to assume
sufficient differentiability of the angular flux and source moments in eq. \eqref{eq:MCP3} and no void regions
(i.e., all $\Sigma_{n} > 0$). For simplicity, let us further focus on the case of isotropic volumetric sources and scattering: 
$$
\begin{gathered}
	q^{(1)} \equiv q,\quad \Sigma_0 = \sigma_t - \sigma_{s0} - \nu\sigma_f = \sigma_a - \nu\sigma_f,\\
	q^{(n)} = 0, \quad \Sigma_n = \sigma_t \equiv \Sigma, \qquad n = 1,2,\ldots
\end{gathered}
$$
(generalization to higher anisotropy degrees is straightforward but technically more involved).

As a starting point, let us take the system \eqref{eq:MCP3} in which the above assumptions are taken into account and
the substitution 
$$
	\fmom[n] \longrightarrow \frac{n!}{(2n-1)!!} \fmom[n]
$$
is made for convenience:
\begin{align}
    \div\fmom[1] +   {\Sigma}_{0}\phi
  	  &=  q 				\label{eq:MCP3_1}  \\[.2em]
    -\div\fmom[2] - \tfrac13\del\phi     
      &=  \Sigma\fmom[1]	\label{eq:MCP3_2}  \\[.2em]
    -\div\fmom[3] - \tfrac25\Sym{\del\otimes\fmom[1]} + \tfrac{2}{15} \eye\otimes\div\fmom[1]
      &=  \Sigma\fmom[2]  	\label{eq:MCP3_3}  \\[.2em]
                         - \tfrac{3}{7}\Sym{\del\otimes\fmom[2]} + \tfrac{6}{35} \Sym{\eye\otimes\div\fmom[2]}
      &=  \Sigma\fmom[3]	\label{eq:MCP3_4}
\end{align}
To further simplify the use of basic tensor identities from App. \ref{app:F}, we consider the equations in a
homogeneous region with constant $\Sigma$ and $\Sigma_0$ \footnote{Note that
this does not preclude heterogeneous subregions with the physical cross-sections $\sigma_a$, $\sigma_{s0}$ and
$\nu\sigma_f$ varying in such a way that $\sigma_a - \nu\sigma_f$ and $\sigma_a + \sigma_s$ are constant.}.
The derivation below obviously extends to the case of sufficiently smooth cross-sections. In practice, however, the 
cross-sections are typically only piecewise constant, which necessitates the specification of interface conditions. 
Formulation of an appropriate set of these conditions (and corresponding boundary conditions) will be the subject of 
further investigation; possible approaches will be discussed in \sref{sec:mcp3_discussion}.

The fourth and third equation can be combined into:
$$
	\Sigma\fmom[2] = \div\left[\frac{3}{7\Sigma}\Sym{\del\otimes\fmom[2]} -
	\frac{6}{35\Sigma}\Sym{\eye\otimes\div\fmom[2]}\right] - \frac{2}{5}\Sym{\del\otimes\fmom[1]} +
	\frac{2}{15}\eye\del\cdot\fmom[1].
$$
Using identity \eqref{eq:tid3}, we obtain
\begin{equation*}\label{eq:phi2_1}
\begin{aligned}
	\Sigma\fmom[2] &= \frac{3}{7\Sigma}\div\Sym{\del\otimes\fmom[2]} -
	\frac{6}{35\Sigma}\left[\frac23\Sym{\del\otimes\div\fmom[2]} + \frac13\Sym{\eye\otimes\div\div\fmom[2]}\right]\\
	&\quad - \frac{2}{5}\Sym{\del\otimes\fmom[1]} + \frac{2}{15}\eye\del\cdot\fmom[1].
\end{aligned}
\end{equation*}
Applying the identity \eqref{eq:tid1} on the first term on right, we obtain the equation involving $\fmom[2]$ only
through its divergence and laplacian:
\begin{equation*}\label{eq:phi2_2}
\begin{aligned}
	&= \frac{2}{7\Sigma}\Sym{\del\otimes\div\fmom[2]} -
	\frac{6}{35\Sigma}\left[\frac23\Sym{\del\otimes\div\fmom[2]} + \frac13\Sym{\eye\otimes\div\div\fmom[2]}\right]\\
	&\quad - \frac{2}{5}\Sym{\del\otimes\fmom[1]} + \frac{2}{15}\eye\del\cdot\fmom[1] + \frac{1}{7\Sigma}\lap\fmom[2]
\end{aligned}
\end{equation*}
Using now eq. \eqref{eq:MCP3_2} for $\div\fmom[2]$ and a little bit of algebra, we obtain
\begin{equation}\label{eq:phi2_3}
\begin{aligned}
	\Sigma\fmom[2] &= -\frac{2}{35\Sigma}\Sym{\del\otimes\del\phi} + \frac{2}{105\Sigma}\eye\lap\phi\\[.2em]
	&\quad - \frac{4}{7}\Sym{\del\otimes\fmom[1]} + \frac{4}{21}\eye\div\fmom[1]\\[.2em]
	&\quad + \frac{1}{7\Sigma}\lap\fmom[2]\\
	&= -\frac{2}{35\Sigma}\detr[2]\Sym{\del\otimes\phi} - \frac{4}{7}\detr[2]\Sym{\del\otimes\fmom[1]} +
	\frac{1}{7\Sigma}\lap\fmom[2].
\end{aligned}	
\end{equation}
Equations \eqref{eq:MCP3_1}, \eqref{eq:MCP3_2} and \eqref{eq:phi2_3} form an equivalent $\MCPN[3]$ system where the
moment $\fmom[3]$ has been eliminated. Combining the first two equations yields
$$
	\div\left(-\frac{1}{3\Sigma}\del\phi - \frac{1}{\Sigma}\div\fmom[2]\right) + \Sigma_0\phi = q.
$$
Since from eq. \eqref{eq:phi2_3} 
$$
\begin{aligned}
\Sigma\div\fmom[2] &= -\frac{4}{105\Sigma}\lap\nabla\phi - \frac{2}{21}\nabla(\div\fmom[1]) - \frac{2}{7}\lap\fmom[1] + 
\frac{1}{7\Sigma}\lap\div\fmom[2]\\[.2em]
&= -\frac{4}{105\Sigma}\lap\del\phi	- \frac{2}{21}\del(\div\fmom[1]) +
\frac{1}{7\Sigma}\lap\left(\div\fmom[2]-2\Sigma\fmom[1]\right)\\[.2em]
&= -\frac{4}{105\Sigma}\lap\del\phi	- \frac{2}{21}\del(\div\fmom[1]) -
\frac{1}{7\Sigma}\lap\left(\frac{1}{3}\del\phi+3\Sigma\fmom[1]\right)\\[.2em]
&= -\frac{3}{35\Sigma}\lap\del\phi	- \frac{2}{21}\del(\div\fmom[1]) -
\frac{3}{7\Sigma}\lap\fmom[1]
\end{aligned}
$$
(identity \eqref{eq:tid2} has been used to obtain the first equality and eq. \eqref{eq:MCP3_2} to obtain the third) and
hence 
$$ \Sigma\div\div\fmom[2] = -\frac{3}{35\Sigma}\del^4\phi-\frac{11}{21}\lap(\del\cdot\fmom[1])
	= -\frac{3}{35\Sigma}\del^4\phi-\frac{11}{21}\lap(q - \Sigma_0\phi),
$$
the $\MCPN[3]$ equations imply that the scalar flux is governed by the following fourth-order PDE:
\begin{equation}\label{eq:scfl}
	\frac{3}{35\Sigma^3}\del^4\phi - \left(\frac{11}{21}\frac{\Sigma_0}{\Sigma^2}+\frac{1}{3\Sigma}\right)\lap\phi +
	\Sigma_0\phi = q - \frac{11}{21\Sigma^2}\lap q.
\end{equation}
In the following subsection, we show that this equation may be recast into a system of diffusion-like equations equivalent
with the $\SPN[3]$ system \eqref{eq:sp3}.

\subsection{Derivation of the $\SPN[3]$-equivalent system}
By multiplying with $\frac{21}{11}\Sigma$ and manipulating the terms, we put eq. \eqref{eq:scfl} into the form
\begin{equation}\label{eq:star}
	\frac{9}{55\Sigma^2}\del^4\phi + \frac{1}{\Sigma}\lap(q-\Sigma_0\phi) - \frac{7}{11}\lap\phi - \frac{21}{11}\Sigma(q -
	\Sigma_0\phi) = 0.
\end{equation}
Let us define an auxiliary function $\theta$ such that
\begin{equation}\label{eq:plus}
	\frac{14}{11}\theta = -\frac{9}{55\Sigma^2}\lap\phi - \frac{1}{\Sigma}(q - \Sigma_0\phi),
\end{equation}
whence
\begin{equation}\label{eq:theta}
	\theta = -\frac{9}{70\Sigma^2}\lap\phi - \frac{11}{14\Sigma}(q - \Sigma_0\phi),
\end{equation}
and
\begin{equation}\label{eq:dot}
	-\frac{7}{11}\lap\phi = \frac{490}{99}\Sigma^2\theta + \frac{35}{9}\Sigma(q-\Sigma_0\phi).
\end{equation}
Comparing eq. \eqref{eq:plus} and first two terms in eq. \eqref{eq:star}, it follows that
$$
	-\frac{14}{11}\lap\theta - \frac{7}{11}\lap\phi - \frac{21}{11}\Sigma(q - \Sigma_0\phi) = 0.
$$
After replacing the second term by eq. \eqref{eq:dot} and simple manipulations, this equation becomes a diffusion-like
equation for $\theta$:
\begin{equation}\label{eq:mcp3_dif_2}
	-\frac{9}{14\Sigma}\lap\theta + \frac{5}{2}\Sigma\theta - \Sigma_0\phi = -q.
\end{equation}
The complementary diffusion-like equation for $\phi$ is obtained from \eqref{eq:plus}:
\begin{equation}\label{eq:mcp3_dif_1}
	-\frac{9}{55\Sigma}\lap\phi + \Sigma_0\phi - \frac{14}{11}\Sigma\theta = q.
\end{equation}
To facilitate the comparison between $\MCPN[3]$ diffusion-like equations \eqref{eq:mcp3_dif_1}, \eqref{eq:mcp3_dif_2} and
$\SPN[3]$ diffusion-like equations \eqref{eq:sp3}, we further multiply eq. \eqref{eq:mcp3_dif_1} by $55/27$ and eq.
\eqref{eq:mcp3_dif_2} by $14/27$ to obtain
\begin{equation}\label{eq:mcp3_dif}
	\begin{aligned}
		-\frac{1}{3\Sigma}\lap\phi + \frac{55}{27}\Sigma_0\phi - \frac{70}{27}\Sigma\theta  &= \frac{55}{27}q,  \\[.2em]
		-\frac{1}{3\Sigma}\lap\theta + \frac{35}{27}\Sigma\theta - \frac{14}{27}\Sigma_0\phi &= -\frac{14}{27}q.
	\end{aligned}
\end{equation}

The $\SPN[3]$ equations in the interior of a homogeneous region with isotropic scattering and sources read:
\begin{equation}\label{eq:mcp3_sp3}
	\begin{aligned}
		-\frac{1}{3\Sigma}\lap\phi^s_0 + \Sigma_0\phi^s_0 - \frac{2}{3}\Sigma_0\phi_s^2 &= q,\\
		-\frac{1}{7\Sigma}\lap\phi^s_2 + \left(\frac{4}{9}\Sigma_0 + \frac{5}{9}\Sigma\right)\phi^s_2 -
		\frac{2}{3}\Sigma_0\phi_s^0 &= -\frac{2}{3}q.
	\end{aligned}
\end{equation}
Recall that the scalar flux is obtained from the $\SPN[3]$ solution by
\begin{equation}\label{eq:mcp3_sp3_phi0}
	\phi = \phi^s_0 - \frac{2}{3}\phi^s_2
\end{equation}
and formally corresponds to the zero-th moment of the 1D $\PN[3]$ equations \eqref{eq:P3_1d}; from \eqref{eq:SP3_mom},
we also have the formal correspondence between the second moments of the 1D $\PN[3]$ and $\SPN[3]$ equations: 
\begin{equation}\label{eq:mcp3_sp3_phi2}
	\phi_2 = \frac{1}{3}\phi^s_2.
\end{equation}
Substitution of \eqref{eq:mcp3_sp3_phi0} within \eqref{eq:mcp3_sp3} leads to
\begin{align}
\label{eq:mcp3_sp3_1}
	-\frac{1}{3\Sigma}\lap\phi^s_0 + \Sigma_0\phi &= q,\\
\label{eq:mcp3_sp3_2}
	-\frac{1}{7\Sigma}\lap\phi^s_2 + \frac{5}{9}\Sigma\phi^s_2 - \frac{2}{3}\Sigma_0\phi
	 &= -\frac{2}{3}q.
\end{align}
Performing now the equivalent transformations 
$$
\begin{gathered}
	\eqref{eq:mcp3_sp3_1} \longrightarrow \eqref{eq:mcp3_sp3_1} - \frac{14}{9}\,\eqref{eq:mcp3_sp3_2},\\
	\eqref{eq:mcp3_sp3_2} \longrightarrow \frac{7}{9}\,\eqref{eq:mcp3_sp3_2},
\end{gathered}
$$
using \eqref{eq:mcp3_sp3_phi2} and putting $\theta = \phi_2$ transforms equations \eqref{eq:mcp3_sp3_1},
\eqref{eq:mcp3_sp3_2} to the $\MCPN[3]$ diffusion-like equations \eqref{eq:mcp3_dif}.

\subsection{Direction for further research of interface conditions}\label{sec:mcp3_discussion}
In an infinite homogeneous medium, the two diffusion-like equations \eqref{eq:mcp3_sp3_1} and
\eqref{eq:mcp3_sp3_2} with \eqref{eq:theta} may be solved for scalar flux $\phi$ equivalent to one that would obtained from the full set
of 16 independent $\MCPN[3]$ equations \eqref{eq:MCP3_1}. Boundary and interface conditions need to be derived for
solving problems in bounded and/or heterogeneous domains. Because of the formal equivalence with the $\SPN[3]$
equations exhibited in the previous subsection, continuity of
$$
	\phi,\quad \theta,\quad \frac{1}{\Sigma}\pd{\phi}{\bn},\quad \frac{1}{\Sigma}\pd{\theta}{\bn}
$$
and boundary conditions analogous to those of the $\SPN[3]$ model (\sref{sec:sp3}) suggest themselves as a first
approximation. Although these conditions let us find a unique solution of equations \eqref{eq:mcp3_sp3_1},
\eqref{eq:mcp3_sp3_2}, they are obviously not in general compatible with the $\MCPN[3]$ model anymore. Generally, the
conditions for $\phi$ and $\theta$ that ensure unique solvability of the coupled diffusion-like equations
\eqref{eq:mcp3_sp3_1}, \eqref{eq:mcp3_sp3_2} need to be obtained from appropriate conditions for the tensorial moments
$\fmom[n]$ (which may be obtained as in the $\PN$ approximation using the formulation \eqref{eq:mcpn1}).

A concrete set of interface conditions compatible with both the equations for angular flux moments and the
diffusion-like equations of the form \eqref{eq:mcp3_sp3_1}, \eqref{eq:mcp3_sp3_2} has been presented in a rather
puzzling paper \cite{Selengut} (see also commentary in \cite[Sec. 5.2]{McClarren2}). Starting from the even-parity NTE,
the author ``derives'' equation \eqref{eq:scfl} and equations \eqref{eq:mcp3_sp3_1}, \eqref{eq:mcp3_sp3_2} as well as
conditions for the even-parity tensorial moments and the unknowns of the diffusion-like equations -- all on a half-page
space. Even though the excessive brevity of the paper prevented further study and practical use of these equations and
conditions, the equivalence of the equations to those systematically derived in previous subsections may motivate the
search for the additional conditions in the same form as in \cite{Selengut}.

\comment{
The latter conditions make use of the expression for the second-order moment in terms of the scalar flux, which  (like
most other parts of the paper) is not given any proper explanation in the paper. In the following subsection, we will 
show that it may actually require additional assumptions on the solution of the NTE, albeit physically 
}

\index{method!of Maxwell-Cartesian spherical harmonics|)}

